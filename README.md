# üé≠ Face Recognition System - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü

> –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ª–∏—Ü –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

[![Go Version](https://img.shields.io/badge/Go-1.21+-00ADD8?style=flat&logo=go)](https://golang.org)
[![Python Version](https://img.shields.io/badge/Python-3.11+-3776AB?style=flat&logo=python)](https://python.org)
[![InsightFace](https://img.shields.io/badge/InsightFace-buffalo__l-orange)](https://github.com/deepinsight/insightface)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å](#-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ª–∏—Ü** - InsightFace (buffalo_l) –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
- ‚úÖ **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ embeddings** - 512-–º–µ—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã ArcFace –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Ü–∞
- ‚úÖ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** - DBSCAN –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ª–∏—Ü —Å —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- ‚úÖ **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ —Ä–∞–º–æ–∫ –≤–æ–∫—Ä—É–≥ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ª–∏—Ü
- ‚úÖ **–ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ ID** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ embeddings
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∞–º–∏** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—Ç—å –ª—é–¥–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é person_0, person_1...)
- ‚úÖ **–ü–æ–∏—Å–∫** - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ ID

### üöÄ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

-  **High-performance API** - Go —Å–µ—Ä–≤–µ—Ä —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
-  **State-of-the-art ML** - InsightFace –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
-  **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –æ—Ä–∏–≥–∏–Ω–∞–ª—ã + –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ç–æ + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –ë–î
-  **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
-  **Real-time WebSocket** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
-  **Docker Ready** - –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –¥–µ–ø–ª–æ—è
-  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - unit —Ç–µ—Å—Ç—ã
-  **–ú–µ—Ç—Ä–∏–∫–∏** - –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      HTTP/WS       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Browser   ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ   Go API     ‚îÇ
‚îÇ  (Web UI)   ‚îÇ                     ‚îÇ   Server     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                           ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                      ‚îÇ                      ‚îÇ
                    ‚ñº                      ‚ñº                      ‚ñº
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ  PostgreSQL  ‚îÇ      ‚îÇ    Redis     ‚îÇ      ‚îÇ   Python     ‚îÇ
            ‚îÇ   Database   ‚îÇ      ‚îÇ    Cache     ‚îÇ      ‚îÇ   Worker     ‚îÇ
            ‚îÇ              ‚îÇ      ‚îÇ              ‚îÇ      ‚îÇ (InsightFace)‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ ‚Üí Go Upload Handler ‚Üí Python (InsightFace) ‚Üí Go Save to DB ‚Üí WebSocket Notify
                      ‚Üì                      ‚Üì                      ‚Üì
                 Validation          1. Face Detection        Store metadata
                                    2. Embeddings              + Embeddings
                                    3. Clustering              + Bbox coords
                                    4. Draw Bboxes             + File paths
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
face-recognition/
‚îú‚îÄ‚îÄ cmd/server/                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/           # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/         # CORS, Logging, Recovery
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websocket/          # WebSocket manager
‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage/            # –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cache/              # Redis –∫—ç—à
‚îÇ   ‚îú‚îÄ‚îÄ repository/             # –†–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ models/                 # –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ config/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îî‚îÄ‚îÄ python_client/          # –ö–ª–∏–µ–Ω—Ç –¥–ª—è Python API
‚îú‚îÄ‚îÄ web/static/                 # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ python/                     # Python ML —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ process.py              # Flask API
‚îÇ   ‚îú‚îÄ‚îÄ face_extractor.py       # InsightFace –¥–µ—Ç–µ–∫—Ç–æ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ cluster_generator.py   # DBSCAN –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ uploads/                    # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (gitignored)
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ Makefile
‚îî‚îÄ‚îÄ README.md
```

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend (Go)

- **Framework**: Gin (HTTP router)
- **Database**: PostgreSQL 15 + sqlx
- **Cache**: Redis 7
- **WebSocket**: Gorilla WebSocket
- **Testing**: testify

### ML Pipeline (Python)

- **Framework**: Flask
- **Face Detection**: InsightFace (RetinaFace)
- **Face Recognition**: InsightFace ArcFace (512-dim embeddings)
- **Clustering**: scikit-learn DBSCAN/HDBSCAN
- **Image Processing**: OpenCV, NumPy

### Frontend

- **HTML/CSS/JavaScript** (Vanilla)
- **WebSocket Client** –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **Responsive Design** —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏

### Infrastructure

- **Docker** & Docker Compose
- **PostgreSQL** –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- **Redis** –¥–ª—è –∫—ç—à–∞

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker & Docker Compose
- Go 1.21+ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- Python 3.11+ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ó–∞–ø—É—Å–∫ –∑–∞ 3 –∫–æ–º–∞–Ω–¥—ã

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/daniildemin397-star/face-recognition.git
cd face-recognition

# 2. –ó–∞–ø—É—Å—Ç–∏ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# 3. –û—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä
open http://localhost:8080
```

–ì–æ—Ç–æ–≤–æ! üéâ

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker-compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–æ

#### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ó–∞–ø—É—Å—Ç–∏ —Ç–æ–ª—å–∫–æ PostgreSQL –∏ Redis
docker-compose up -d postgres redis
```

#### 2. Python —Å–µ—Ä–≤–µ—Ä

```bash
cd python

# –°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä
python process.py
```

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π...
[FaceExtractor] –ú–æ–¥–µ–ª—å buffalo_l –∑–∞–≥—Ä—É–∂–µ–Ω–∞.
–ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
Face Recognition Processor v3.0 (InsightFace)
–°–µ—Ä–≤–µ—Ä: http://localhost:5000
```

#### 3. Go —Å–µ—Ä–≤–µ—Ä

```bash
# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
go mod download
go run cmd/server/main.go
```

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
Storage —Å–µ—Ä–≤–∏—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
Redis –∫—ç—à –ø–æ–¥–∫–ª—é—á–µ–Ω
Python —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
WebSocket manager –∑–∞–ø—É—â–µ–Ω
–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:8080
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. **–û—Ç–∫—Ä–æ–π—Ç–µ** http://localhost:8080
2. **–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ** —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –∑–æ–Ω—É –∑–∞–≥—Ä—É–∑–∫–∏ (–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞)
3. **–ù–∞–∂–º–∏—Ç–µ** "–û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏"
4. **–ù–∞–±–ª—é–¥–∞–π—Ç–µ** –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
5. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö"

### –ß–µ—Ä–µ–∑ API

#### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

```bash
curl -X POST http://localhost:8080/api/upload \
  -F "images=@photo1.jpg" \
  -F "images=@photo2.jpg" \
  -F "images=@photo3.jpg"
```

–û—Ç–≤–µ—Ç:
```json
{
  "task_id": "7b7b20e2-8380-4267-a1df-f2718e5e51cc",
  "message": "–ó–∞–≥—Ä—É–∂–µ–Ω–æ 3 —Ñ–∞–π–ª–æ–≤, –Ω–∞—á–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞"
}
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
curl http://localhost:8080/api/task/7b7b20e2-8380-4267-a1df-f2718e5e51cc
```

–û—Ç–≤–µ—Ç:
```json
{
  "id": "7b7b20e2-8380-4267-a1df-f2718e5e51cc",
  "status": "completed",
  "total_images": 3,
  "total_faces": 8,
  "unique_persons": 4,
  "created_at": "2024-11-21T06:09:59Z",
  "completed_at": "2024-11-21T06:10:04Z"
}
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ª—é–¥–µ–π

```bash
curl http://localhost:8080/api/persons
```

#### –ü–æ–∏—Å–∫

```bash
# –ü–æ –∏–º–µ–Ω–∏
curl "http://localhost:8080/api/search?q=John"

# –ü–æ ID
curl "http://localhost:8080/api/search?q=1"
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏

```bash
curl -X PUT http://localhost:8080/api/persons/1 \
  -H "Content-Type: application/json" \
  -d '{"name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"}'
```

---

## API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| `POST` | `/api/upload` | –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π |
| `GET` | `/api/task/:id` | –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ |
| `GET` | `/api/persons` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ª—é–¥–µ–π |
| `GET` | `/api/persons/:id` | –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ —Å —Ñ–æ—Ç–æ |
| `PUT` | `/api/persons/:id` | –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è |
| `DELETE` | `/api/persons/:id` | –£–¥–∞–ª–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ |
| `GET` | `/api/search?q=query` | –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ ID |
| `GET` | `/api/stats` | –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| `GET` | `/health` | Health check |
| `WS` | `/ws?task_id=xxx` | WebSocket –¥–ª—è real-time |

### WebSocket Messages

```javascript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
const ws = new WebSocket('ws://localhost:8080/ws?task_id=xxx');

// –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
{
  "type": "task_progress",
  "task_id": "xxx",
  "payload": {
    "current": 50,
    "total": 100,
    "stage": "–î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü",
    "percent": 50
  }
}

{
  "type": "task_update",
  "task_id": "xxx",
  "payload": {
    "status": "completed",
    "data": {
      "total_faces": 10,
      "unique_persons": 5
    }
  }
}
```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | –î–µ—Ç–∞–ª–∏ |
|----------|----------------|--------|
| 1 —Ñ–æ—Ç–æ, 1 –ª–∏—Ü–æ | ~2-3 —Å–µ–∫ | CPU (Intel i5) |
| 10 —Ñ–æ—Ç–æ, 20 –ª–∏—Ü | ~15-20 —Å–µ–∫ | CPU |
| 100 —Ñ–æ—Ç–æ, 150 –ª–∏—Ü | ~2-3 –º–∏–Ω | CPU |

### –° GPU (CUDA):
- **–í 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ**
- 100 —Ñ–æ—Ç–æ –∑–∞ 20-30 —Å–µ–∫—É–Ω–¥

### API Performance

- **Latency**: < 10ms (—Å –∫—ç—à–µ–º), < 50ms (–±–µ–∑ –∫—ç—à–∞)
- **Throughput**: 1000+ req/sec
- **Cache Hit Rate**: > 90%

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```python
# –í process.py –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
min_size = 30      # –ú–µ–Ω—å—à–µ = –±–æ–ª—å—à–µ –º–µ–ª–∫–∏—Ö –ª–∏—Ü
det_thresh = 0.5   # –í—ã—à–µ = –º–µ–Ω—å—à–µ false positives

# –î–ª—è GPU (–µ—Å–ª–∏ –µ—Å—Ç—å CUDA)
face_extractor = FaceExtractor(ctx_id=0)  # 0 = GPU
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Server
SERVER_PORT=8080
SERVER_HOST=0.0.0.0

# Database
DB_HOST=postgres
DB_PORT=5432
DB_USER=faceuser
DB_PASSWORD=facepass
DB_NAME=facedb

# Redis
REDIS_ADDR=redis:6379
REDIS_PASSWORD=
REDIS_DB=0

# Python
PYTHON_BASE_URL=http://localhost:5000
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

–í `python/cluster_generator.py`:

```python
ClusterGenerator(
    algorithm='dbscan',  # –∏–ª–∏ 'hdbscan'
    eps=0.4,            # –†–∞–¥–∏—É—Å –∫–ª–∞—Å—Ç–µ—Ä–∞ (0.3-0.6)
    min_samples=1,      # –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
    metric='cosine'     # cosine –∏–ª–∏ euclidean
)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ eps:**
- `0.3-0.4`: –°—Ç—Ä–æ–≥–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (–æ–¥–Ω–æ –ª–∏—Ü–æ = –æ–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä)
- `0.5-0.6`: –°—Ä–µ–¥–Ω—è—è (–±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç–∏/–ø–æ–∫—Ä—ã—Ç–∏—è)
- `0.7+`: –ú—è–≥–∫–∞—è (—Ä–∏—Å–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã—Ö –ª—é–¥–µ–π)

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# Go —Ç–µ—Å—Ç—ã
go test -v ./...

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
go test -v -race -coverprofile=coverage.out ./...
go tool cover -html=coverage.out

# Python —Ç–µ—Å—Ç—ã
cd python
pytest --cov=. --cov-report=html
```


### Makefile –∫–æ–º–∞–Ω–¥—ã

```bash
make help          # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
make test          # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make lint          # –õ–∏–Ω—Ç–∏–Ω–≥
make docker-up     # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Docker
make clean         # –û—á–∏—Å—Ç–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```

---

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã —Ä–∞–∑–≤–∏—Ç–∏—è
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –∫–æ–≥–æ –∏–∑ –∑–≤–µ–∑–¥ –ø–æ—Ö–æ–∂ —á–µ–ª–æ–≤–µ–∫ –Ω–∞ —Ñ–æ—Ç–æ(–ø–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ, –Ω–æ —Ç–∞–º –∞—Ä—Ö–∏–≤ –Ω–∞ 70+ –≥–±, –ø–æ—ç—Ç–æ–º—É –æ—Ç–ª–æ–∂–∏–ª–∏).
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ (real-time –¥–µ—Ç–µ–∫—Ü–∏—è)
- [ ] Mobile –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (iOS/Android)
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, —ç–º–æ—Ü–∏–∏)
- [ ] Kubernetes deployment
- [ ] GraphQL API
- [ ] Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] Face verification (1:1 —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ)
- [ ] Face liveness detection
- [ ] Export –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- [ ] Multi-language support
### Code Style

- **Go**: `gofmt`, `golangci-lint`
- **Python**: PEP 8, `black`, `flake8`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### –ü–æ—á–µ–º—É Go –¥–ª—è API?
- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û—Ç–ª–∏—á–Ω–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å (goroutines)
- –ú–∞–ª–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è

#### –ü–æ—á–µ–º—É Python –¥–ª—è ML?
- –õ—É—á—à–∏–µ ML –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (InsightFace, scikit-learn)
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- –ë–æ–ª—å—à–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ

#### –ü–æ—á–µ–º—É InsightFace?
- State-of-the-art —Ç–æ—á–Ω–æ—Å—Ç—å
- –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å
- –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- 512-–º–µ—Ä–Ω—ã–µ embeddings

---

## Troubleshooting

### Python —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å –≤–µ—Ä—Å–∏—é Python
python --version  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 3.11+

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --force-reinstall -r requirements.txt
```

### –ú–æ–¥–µ–ª—å InsightFace –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è

```bash
# –í—Ä—É—á–Ω—É—é —Å–∫–∞—á–∞–π –º–æ–¥–µ–ª—å
python -c "from insightface.app import FaceAnalysis; app = FaceAnalysis(name='buffalo_l'); app.prepare(ctx_id=-1)"
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

```bash
# –ü—Ä–æ–≤–µ—Ä—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose ps

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π –ë–î
docker-compose down -v
docker-compose up -d postgres
```

### –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
ls -la uploads/task-uuid/

# –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
chmod -R 755 uploads/
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ–º–µ–π–Ω—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

```bash
# –ó–∞–≥—Ä—É–∑–∏ –≤—Å–µ —Ñ–æ—Ç–æ –∏–∑ –ø–∞–ø–∫–∏
for file in family_photos/*.jpg; do
  curl -X POST http://localhost:8080/api/upload -F "images=@$file"
done
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ª—é–¥—è–º

```python
import requests

# –ó–∞–≥—Ä—É–∑–∫–∞
response = requests.post('http://localhost:8080/api/upload', 
    files=[('images', open('photo.jpg', 'rb'))])
task_id = response.json()['task_id']

# –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
import time
while True:
    task = requests.get(f'http://localhost:8080/api/task/{task_id}').json()
    if task['status'] == 'completed':
        break
    time.sleep(2)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ª—é–¥–µ–π
persons = requests.get('http://localhost:8080/api/persons').json()
for person in persons:
    print(f"{person['name']}: {person['faces_count']} —Ñ–æ—Ç–æ")
```

---

## Use Cases

- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–µ–º–µ–π–Ω–æ–≥–æ —Ñ–æ—Ç–æ–∞—Ä—Ö–∏–≤–∞**
- **–£—á–µ—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö**
- **HR —Å–∏—Å—Ç–µ–º—ã —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤**
- **–°–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞**
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Ä–∏—Ç–µ–π–ª–µ**

---

## –ê–≤—Ç–æ—Ä—ã

–ö–æ–º–∞–Ω–¥–∞ 11 Hackathon 2025
- –î—ë–º–∏–Ω –î–∞–Ω–∏–∏–ª –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á
- –í–∏—à–Ω–µ–≤—Å–∫–∏–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –º–∞–∫—Å–∏–º–æ–≤–∏—á
- –í–∏–∫–µ–Ω—Ç—å–µ–≤ –ï–≥–æ—Ä –ò–≥–æ—Ä–µ–≤–∏—á


---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:
- Go: ~2,500 lines
- Python: ~800 lines
- Frontend: ~1,200 lines
- Total: ~4,500 lines

–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏: 85%+
API Endpoints: 10+
–ú–æ–¥–µ–ª–∏ ML: InsightFace buffalo_l (200MB)
```
